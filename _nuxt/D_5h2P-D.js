import{u as Ee,_ as Oe}from"./DHxqMZTa.js";import{_ as Ce}from"./tO4SEBpb.js";import{g as Re,u as Y}from"./DSH17dUK.js";import{M as fe,r as _e,S as je,c as I,t as k,j as D,I as ye,D as $e,am as Ae,V as Se,d as Ve,ag as Le,a as j,g as V,h as G,w as de,o as A,u as o,B as me,n as qe,F as q,b as F,e as z,p as De,_ as Be}from"./CWhwJZo3.js";import{r as Ne}from"./-vsEa_js.js";import{r as We,e as Ie}from"./bW-XWXCK.js";import{m as ke}from"./DbYZnSlv.js";import{u as ze}from"./DMAP_NgG.js";import{u as He}from"./DD2x-z_y.js";import{V as pe}from"./D9oWiPIM.js";import"./BEqXSnTe.js";import"./BfJ2HLID.js";import"./CvAqvVfO.js";import"./DMKteXuo.js";import"./CILVA7lc.js";var ne,ve;function Pe(){if(ve)return ne;ve=1;var x=We(),v=function(){return x.Date.now()};return ne=v,ne}var re,he;function Fe(){if(he)return re;he=1;var x=/\s/;function v(f){for(var _=f.length;_--&&x.test(f.charAt(_)););return _}return re=v,re}var oe,be;function Xe(){if(be)return oe;be=1;var x=Fe(),v=/^\s+/;function f(_){return _&&_.slice(0,x(_)+1).replace(v,"")}return oe=f,oe}var se,ge;function Ue(){if(ge)return se;ge=1;var x=Xe(),v=Ne(),f=Ie(),_=NaN,M=/^[-+]0x[0-9a-f]+$/i,E=/^0b[01]+$/i,S=/^0o[0-7]+$/i,d=parseInt;function $(s){if(typeof s=="number")return s;if(f(s))return _;if(v(s)){var T=typeof s.valueOf=="function"?s.valueOf():s;s=v(T)?T+"":T}if(typeof s!="string")return s===0?s:+s;s=x(s);var O=E.test(s);return O||S.test(s)?d(s.slice(2),O?2:8):M.test(s)?_:+s}return se=$,se}var ie,xe;function Ye(){if(xe)return ie;xe=1;var x=Ne(),v=Pe(),f=Ue(),_="Expected a function",M=Math.max,E=Math.min;function S(d,$,s){var T,O,C,i,r,m,p=0,R=!1,w=!1,B=!0;if(typeof d!="function")throw new TypeError(_);$=f($)||0,x(s)&&(R=!!s.leading,w="maxWait"in s,C=w?M(f(s.maxWait)||0,$):C,B="trailing"in s?!!s.trailing:B);function W(t){var u=T,b=O;return T=O=void 0,p=t,i=d.apply(b,u),i}function N(t){return p=t,r=setTimeout(a,$),R?W(t):i}function g(t){var u=t-m,b=t-p,h=$-u;return w?E(h,C-b):h}function L(t){var u=t-m,b=t-p;return m===void 0||u>=$||u<0||w&&b>=C}function a(){var t=v();if(L(t))return l(t);r=setTimeout(a,g(t))}function l(t){return r=void 0,B&&T?W(t):(T=O=void 0,i)}function c(){r!==void 0&&clearTimeout(r),p=0,T=m=O=r=void 0}function e(){return r===void 0?i:l(v())}function n(){var t=v(),u=L(t);if(T=arguments,O=this,m=t,u){if(r===void 0)return N(m);if(w)return clearTimeout(r),r=setTimeout(a,$),W(m)}return r===void 0&&(r=setTimeout(a,$)),i}return n.cancel=c,n.flush=e,n}return ie=S,ie}var Ge=Ye();const Je=Re(Ge),ae=x=>x?"$el"in x?x.$el:x:null,Ke=({combineMap:x,colorsCount:v,stroke:f=4,excludeItems:_})=>{const M=fe({}),E=fe({}),S=_e(null),d=je(),$=I(()=>Array.from({length:k(v)},(i,r)=>`hsl(${360/k(v)*r} 30% 40%)`)),s=Je(()=>{const i=k(x),r=k(E),m=k(_),p=ke(k(M),e=>{if(e)return{x:e.offsetLeft,y:e.offsetTop,w:e.offsetWidth,h:e.offsetHeight}}),R=Object.fromEntries(Object.values(p).filter(D).map(({y:e})=>[e,f*3])),w=Math.max(...Object.values(p).filter(D).map(({h:e})=>e)),B=Object.values(R).reduce((e,n,t,u)=>t?Math.min(Math.abs(Number(n)-Number(u[t-1])-w),e):e,1e4),W=e=>{let t=R[e]+f*3;return t>B-f&&(t=f),R[e]=t,t},N={},g=Math.min(...Object.values(p).filter(D).map(({w:e})=>e)),L=e=>{if(!(e in N))return N[e]=g/4,N[e];let n=N[e]+g/4;return n>g&&(n=g/4),N[e]=n,n},a={},l=e=>{if(!(e in a))return a[e]=0,$.value[0];let n=a[e]+1;return n>$.value.length-1&&(n=0),a[e]=n,$.value[n]};let c=-1;for(const e in p){if(m!=null&&m.includes(e))continue;c--;const n=p[e];if(!n)continue;const{x:t,y:u,w:b,h}=n,H=l(u),P=r[`${e}-connect-inner`];if(!P)continue;const le=Object.fromEntries(i[e].flat().map(y=>[y,r[`${e}-connect-${y}`]])),J=Object.values(le).filter(D);if(J.length!==i[e].flat().length)continue;const K=Object.fromEntries(i[e].flat().map(y=>[y,r[`${e}-child-${y}`]])),ce=Object.values(K).filter(D);if(ce.length!==i[e].flat().length)continue;ce.concat(J).concat(P).forEach(({style:y})=>{y.borderWidth=`${f/2}px`,y.borderColor=H,y.zIndex=`${c}`});const X=u+h+f+W(u);J.forEach(({style:y})=>{y.top=`${X}px`});const Q=t+b/2-f/2;P.style.left=`${Q}px`,P.style.top=`${u+h}px`,P.style.height=`${X-u-h}px`;for(const y in K){if(m!=null&&m.includes(y))continue;const U=K[y],Z=le[y],ue=p[y];if(!ue||!U||!Z)continue;const{x:ee,y:Me,w:Te}=ue,te=t===ee?ee+Te/2-f/2:ee+L(y);U.style.left=`${te}px`,U.style.top=`${X+f/2}px`,U.style.height=`${Me-X}px`;const we=Math.min(Q,te);Z.style.left=`${we}px`,Z.style.width=`${Math.abs(Q-te)+f*.75}px`}}},200);return ye(()=>{var r;if(d.value=new ResizeObserver(()=>{s()}),!S.value)return;d.value.observe(S.value);const i=Object.values(M).filter(D).at(0);i&&((r=d.value)==null||r.observe(i))}),$e(S,(i,r)=>{var m,p,R;if(r&&((m=d.value)==null||m.unobserve(r)),i){(p=d.value)==null||p.observe(i);const w=Object.values(M).filter(D).at(0);w&&((R=d.value)==null||R.observe(w)),Se(()=>s.flush())}}),Ae(()=>{var i;(i=d.value)==null||i.disconnect()}),{containerRef:i=>{S.value=ae(i)},itemRef:i=>r=>{M[i]=ae(r)},boundRef:(i,r,m)=>p=>{E[`${i}-${r}-${m}`]=ae(p)}}},Qe={class:"d-flex align-center justify-end"},Ze=["onClick","onMouseenter"],et=["innerHTML"],tt=["data-debug"],nt=["data-debug"],rt=["data-debug"],ot=Ve({__name:"artifacts",async setup(x){let v,f;const _=new Intl.Collator("en").compare,M=Y("artiShowPath","false"),E=Y("artiDisabledTooltips","false"),S=Y("tooltipsDisabled","false"),{raceData:d,iconProps:$,iconsSrc:s,version:T}=([v,f]=Le(()=>Ee("artifacts")),v=await v,f(),v),O=Y("iconSize"),C=I(()=>(d==null?void 0:d.items)??[]),i=I(()=>{const a=C.value.filter(({level:c,id:e})=>c>1&&!(e in d.combineMap)).map(({id:c})=>c),l=Object.entries(d.combineMap).filter(([,c])=>c.flat().every(e=>a.includes(e))).map(([c])=>c);return a.concat(l).map(c=>C.value.find(e=>e.id===c)).filter(D)}),r=I(()=>Math.max(...C.value.map(({level:a})=>a),0)),m=I(()=>Math.max(...C.value.reduce((a,{level:l})=>(a[l]||(a[l]=0),++a[l],a),[0]))),{boundRef:p,containerRef:R,itemRef:w}=Ke({colorsCount:m,combineMap:d.combineMap,stroke:6}),B=I(()=>{const a=C.value.filter(({id:c})=>!i.value.some(e=>e.id===c)).sort(({level:c,hotkey:e},{level:n,hotkey:t})=>n!==c?n-c:_(e,t)),l=Array();do{const c=a.findIndex(({level:t},u,b)=>{var h;return((h=b[u+1])==null?void 0:h.level)!==t});if(c<0)continue;const e=a.splice(0,c+1),n=l[l.length-1];if(!n){l.push(e);continue}e.sort(({id:t})=>i.value.some(u=>(u==null?void 0:u.id)===t)?1:d.combineMap[n[0].id][0].includes(t)?-1:0),l.push(e)}while(a.length);return l.flat()}),W=I(()=>({gridTemplateColumns:`repeat(${m.value+1}, 1fr)`,gridTemplateRows:`repeat(${r.value}, 1fr)`})),N=ze(),g=_e(Array()),L=a=>{const l=Array(),c=(e,n,t)=>{if(l.includes(e))return;l.push(e);const u=d.combineMap[e];u&&!t&&u.forEach(b=>b.forEach(h=>c(h,!0,!1))),n||Object.entries(d.combineMap).filter(([,b])=>b.some(h=>h.includes(e))).forEach(([b])=>c(b,!1,!0))};c(a,!1,!1),g.value=l};return $e(N,a=>{a&&L(a)}),ye(()=>{N.value&&L(N.value)}),He({title:`Artifacts v${T}`,description:"Artifacts of Survival Chaos: all heroes combined artifacts"}),(a,l)=>{const c=Oe,e=Ce;return A(),j("div",null,[l[3]||(l[3]=V("div",{class:"text-center d-none"},[V("h1",{class:"text-h2 font-bold title mb-6"},"Artifacts")],-1)),G(e,{title:""},{default:de(()=>[V("div",Qe,[G(pe,{label:"Disable tooltips","true-value":"true","false-value":"false",modelValue:o(E),"onUpdate:modelValue":l[0]||(l[0]=n=>me(E)?E.value=n:null),class:"mx-4"},null,8,["modelValue"]),G(pe,{label:"Always show path","true-value":"true","false-value":"false",modelValue:o(M),"onUpdate:modelValue":l[1]||(l[1]=n=>me(M)?M.value=n:null)},null,8,["modelValue"])]),V("div",{class:"container",ref:o(R)},[V("div",{class:"items-container",style:qe(o(W))},[(A(!0),j(q,null,F(o(r),n=>(A(),j("div",{class:z([`level${o(r)+1-n}`,"text-h5","text-no-wrap"])}," Lvl "+De(n),3))),256)),(A(!0),j(q,null,F(o(B).concat(o(i)),n=>(A(),j("div",{class:z([`level${o(r)+1-n.level}`,"cursor-pointer",{depressed:o(g).length&&!o(g).includes(n.id),selected:o(N)===n.id}]),ref_for:!0,ref:o(w)(n.id),onClick:()=>N.value=o(N)===n.id?void 0:n.id,onMouseenter:()=>!o(N)&&L(n.id),onMouseout:l[2]||(l[2]=()=>!o(N)&&(g.value=[]))},[G(c,{src:o(s),description:n.description,coords:o($)(n.id),disabled:o(E)==="true"||o(S)==="true",width:+o(O)*.75},{tooltip:de(()=>[V("div",{innerHTML:n.name},null,8,et)]),_:2},1032,["src","description","coords","disabled","width"])],42,Ze))),256))],4),V("div",{class:z(["path-container",{hidden:o(M)!=="true"&&!o(g).length}])},[(A(!0),j(q,null,F(o(d).combineMap,(n,t)=>(A(),j(q,{key:`node-${t}`},[V("div",{ref_for:!0,ref:o(p)(t,"connect","inner"),"data-debug":`${t}-connect-inner`,class:z({depressed:o(g).length&&!o(g).includes(t),pathNode:!0})},null,10,tt),(A(!0),j(q,null,F(n,(u,b)=>(A(),j(q,{key:`node-${t}-${b}`},[(A(!0),j(q,null,F(u,h=>(A(),j(q,null,[V("div",{ref_for:!0,ref:o(p)(t,"connect",h),"data-debug":`${t}-connect-${h}`,class:z({depressed:o(g).length&&![t,h].every(H=>o(g).includes(H)),pathNode:!0,optionalNode:b!==0})},null,10,nt),V("div",{ref_for:!0,ref:o(p)(t,"child",h),"data-debug":`${t}-${h}`,class:z({depressed:o(g).length&&![t,h].every(H=>o(g).includes(H)),pathNode:!0,optionalNode:b!==0})},null,10,rt)],64))),256))],64))),128))],64))),128))],2)],512)]),_:1})])}}}),yt=Be(ot,[["__scopeId","data-v-3c85bd04"]]);export{yt as default};
